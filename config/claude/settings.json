{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "alwaysThinkingEnabled": true,
  "enabledPlugins": {
    "code-review@nix-plugins": true,
    "feature-dev@nix-plugins": true,
    "ralph-wiggum@nix-plugins": true
  },
  "hooks": {
    "PostToolUse": [
      {
        "hooks": [
          {
            "command": "claude-formatter",
            "type": "command"
          }
        ],
        "matcher": "Edit|Write"
      }
    ],
    "PreToolUse": [
      {
        "hooks": [
          {
            "command": "~/.claude/hooks/check-bash-command.sh",
            "type": "command"
          }
        ],
        "matcher": "Bash"
      },
      {
        "hooks": [
          {
            "command": "echo '{\"decision\": \"block\", \"reason\": \"This will delete a file. Confirm this is intended before proceeding.\"}'",
            "type": "command"
          }
        ],
        "matcher": "mcp__filesystem__delete_file"
      },
      {
        "hooks": [
          {
            "command": "echo '{\"decision\": \"block\", \"reason\": \"Storing to Qdrant memory. This persists across sessions and auto-injects into future prompts. Confirm with user.\"}'",
            "type": "command"
          }
        ],
        "matcher": "mcp__qdrant__qdrant-store"
      },
      {
        "hooks": [
          {
            "command": "echo '{\"decision\": \"block\", \"reason\": \"Writing to persistent Serena memory. Confirm with user.\"}'",
            "type": "command"
          }
        ],
        "matcher": "mcp__serena__write_memory"
      }
    ],
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "command": "~/.claude/hooks/scan-project.sh",
            "type": "command"
          },
          {
            "command": "~/.claude/hooks/auto-recall.sh",
            "type": "command"
          }
        ],
        "matcher": ""
      }
    ]
  },
  "permissions": {
    "allow": [
      "Bash(ls:*)",
      "Bash(head:*)",
      "Bash(tail:*)",
      "Bash(wc:*)",
      "Bash(file:*)",
      "Bash(pwd:*)",
      "Bash(whoami:*)",
      "Bash(uname:*)",
      "Bash(date:*)",
      "Bash(which:*)",
      "Bash(type:*)",
      "Bash(eza:*)",
      "Bash(bat:*)",
      "Bash(fd:*)",
      "Bash(rg:*)",
      "Bash(grep:*)",
      "Bash(jq:*)",
      "Bash(tokei:*)",
      "Bash(nix-tree:*)",
      "Bash(nix-diff:*)",
      "Bash(nix-search:*)",
      "Bash(gh pr view:*)",
      "Bash(gh pr list:*)",
      "Bash(gh pr status:*)",
      "Bash(gh pr diff:*)",
      "Bash(gh pr checks:*)",
      "Bash(gh issue view:*)",
      "Bash(gh issue list:*)",
      "Bash(gh issue status:*)",
      "Bash(gh repo view:*)",
      "Bash(gh repo list:*)",
      "Bash(gh run view:*)",
      "Bash(gh run list:*)",
      "Bash(gh release view:*)",
      "Bash(gh release list:*)",
      "Bash(gh api:*)",
      "Bash(gh auth status:*)",
      "Bash(gh search:*)",
      "Bash(git log:*)",
      "Bash(git status:*)",
      "Bash(git diff:*)",
      "Bash(git show:*)",
      "Bash(git branch:*)",
      "Bash(procs:*)",
      "Bash(btop:*)",
      "Bash(delta:*)",
      "Bash(difftastic:*)",
      "Bash(nix flake show:*)",
      "Bash(nix flake metadata:*)",
      "Bash(nix flake info:*)",
      "Bash(nix flake check:*)",
      "Bash(nix search:*)",
      "Bash(nix derivation show:*)",
      "Bash(nix why-depends:*)",
      "Bash(nix path-info:*)",
      "Bash(nix store ls:*)",
      "Bash(nix store diff-closures:*)",
      "Bash(nix profile list:*)",
      "Bash(nix registry list:*)",
      "Bash(nix log:*)",
      "Bash(nix hash:*)",
      "Bash(nix-store --query:*)",
      "Bash(nix-store -q:*)",
      "Bash(nix-instantiate --eval:*)",
      "Bash(cargo check:*)",
      "Bash(cargo test:*)",
      "Bash(cargo clippy:*)",
      "Bash(cargo fmt --check:*)",
      "Bash(cargo doc:*)",
      "Bash(cargo tree:*)",
      "Bash(cargo metadata:*)",
      "Bash(go list:*)",
      "Bash(go mod graph:*)",
      "Bash(go doc:*)",
      "Bash(go vet:*)",
      "Bash(forge build:*)",
      "Bash(forge test:*)",
      "Bash(forge doc:*)",
      "Bash(cast call:*)",
      "Bash(cast decode:*)",
      "Bash(cast abi-encode:*)",
      "Bash(cast abi-decode:*)",
      "Bash(cast sig:*)",
      "Bash(cast interface:*)",
      "Bash(cast chain-id:*)",
      "Bash(alejandra:*)",
      "Bash(statix:*)",
      "Bash(deadnix:*)",
      "Bash(selene:*)",
      "Bash(stylua:*)",
      "Read",
      "Glob",
      "Grep",
      "WebFetch",
      "WebSearch",
      "Read(//nix/store/**)",
      "mcp__filesystem__read_file",
      "mcp__filesystem__read_text_file",
      "mcp__filesystem__read_media_file",
      "mcp__filesystem__read_multiple_files",
      "mcp__filesystem__list_directory",
      "mcp__filesystem__list_directory_with_sizes",
      "mcp__filesystem__directory_tree",
      "mcp__filesystem__search_files",
      "mcp__filesystem__get_file_info",
      "mcp__filesystem__list_allowed_directories",
      "mcp__git__git_status",
      "mcp__git__git_diff_unstaged",
      "mcp__git__git_diff_staged",
      "mcp__git__git_diff",
      "mcp__git__git_log",
      "mcp__git__git_show",
      "mcp__git__git_branch",
      "mcp__github__get_file_contents",
      "mcp__github__get_commit",
      "mcp__github__get_me",
      "mcp__github__get_tag",
      "mcp__github__get_label",
      "mcp__github__get_latest_release",
      "mcp__github__get_release_by_tag",
      "mcp__github__get_team_members",
      "mcp__github__get_teams",
      "mcp__github__list_branches",
      "mcp__github__list_commits",
      "mcp__github__list_issues",
      "mcp__github__list_pull_requests",
      "mcp__github__list_releases",
      "mcp__github__list_tags",
      "mcp__github__list_issue_types",
      "mcp__github__issue_read",
      "mcp__github__pull_request_read",
      "mcp__github__search_code",
      "mcp__github__search_issues",
      "mcp__github__search_pull_requests",
      "mcp__github__search_repositories",
      "mcp__github__search_users",
      "mcp__serena__activate_project",
      "mcp__serena__check_onboarding_performed",
      "mcp__serena__get_current_config",
      "mcp__serena__list_dir",
      "mcp__serena__read_file",
      "mcp__serena__read_memory",
      "mcp__serena__list_memories",
      "mcp__serena__find_file",
      "mcp__serena__get_symbols_overview",
      "mcp__serena__find_symbol",
      "mcp__serena__find_referencing_symbols",
      "mcp__serena__search_for_pattern",
      "mcp__serena__initial_instructions",
      "mcp__serena__onboarding",
      "mcp__serena__think_about_collected_information",
      "mcp__serena__think_about_task_adherence",
      "mcp__serena__think_about_whether_you_are_done",
      "mcp__serena__write_memory",
      "mcp__tavily__tavily-search",
      "mcp__tavily__tavily-extract",
      "mcp__tavily__tavily-crawl",
      "mcp__tavily__tavily-map",
      "mcp__context7__resolve-library-id",
      "mcp__context7__get-library-docs",
      "mcp__memory__read_graph",
      "mcp__memory__search_nodes",
      "mcp__memory__open_nodes",
      "mcp__memory__create_entities",
      "mcp__memory__create_relations",
      "mcp__memory__add_observations",
      "mcp__nixos__nixos_search",
      "mcp__nixos__nixos_info",
      "mcp__nixos__nixos_channels",
      "mcp__nixos__nixos_stats",
      "mcp__nixos__home_manager_search",
      "mcp__nixos__home_manager_info",
      "mcp__nixos__home_manager_stats",
      "mcp__nixos__home_manager_list_options",
      "mcp__nixos__home_manager_options_by_prefix",
      "mcp__nixos__darwin_search",
      "mcp__nixos__darwin_info",
      "mcp__nixos__darwin_stats",
      "mcp__nixos__darwin_list_options",
      "mcp__nixos__darwin_options_by_prefix",
      "mcp__nixos__nixos_flakes_stats",
      "mcp__nixos__nixos_flakes_search",
      "mcp__nixos__nixhub_package_versions",
      "mcp__nixos__nixhub_find_version",
      "mcp__deepl__get-source-languages",
      "mcp__deepl__get-target-languages",
      "mcp__deepl__translate-text",
      "mcp__deepl__get-writing-styles",
      "mcp__deepl__get-writing-tones",
      "mcp__deepl__rephrase-text",
      "mcp__deepl__list-glossaries",
      "mcp__deepl__get-glossary",
      "mcp__deepl__get-glossary-dictionary-entries",
      "mcp__time__get_current_time",
      "mcp__time__convert_time",
      "mcp__sequential-thinking__sequentialthinking",
      "mcp__qdrant__qdrant-store",
      "mcp__qdrant__qdrant-find"
    ],
    "deny": [
      "Read(@homeDir@/.ssh/**)",
      "Write(@homeDir@/.ssh/**)",
      "Edit(@homeDir@/.ssh/**)",
      "Read(@homeDir@/.aws/**)",
      "Write(@homeDir@/.aws/**)",
      "Edit(@homeDir@/.aws/**)",
      "Read(@homeDir@/.kube/**)",
      "Write(@homeDir@/.kube/**)",
      "Edit(@homeDir@/.kube/**)",
      "Read(@homeDir@/.gnupg/**)",
      "Write(@homeDir@/.gnupg/**)",
      "Edit(@homeDir@/.gnupg/**)",
      "Read(@homeDir@/.config/sops/**)",
      "Write(@homeDir@/.config/sops/**)",
      "Edit(@homeDir@/.config/sops/**)",
      "Read(@homeDir@/.config/nix/**)",
      "Write(@homeDir@/.config/nix/**)",
      "Edit(@homeDir@/.config/nix/**)",
      "Read(@homeDir@/.config/gh/**)",
      "Write(@homeDir@/.config/gh/**)",
      "Edit(@homeDir@/.config/gh/**)",
      "Read(@homeDir@/.config/gcloud/**)",
      "Write(@homeDir@/.config/gcloud/**)",
      "Edit(@homeDir@/.config/gcloud/**)",
      "Read(@homeDir@/.config/Bitwarden CLI/**)",
      "Write(@homeDir@/.config/Bitwarden CLI/**)",
      "Edit(@homeDir@/.config/Bitwarden CLI/**)",
      "Read(@homeDir@/Library/Keychains/**)",
      "Write(@homeDir@/Library/Keychains/**)",
      "Edit(@homeDir@/Library/Keychains/**)",
      "Read(@homeDir@/Library/Messages/**)",
      "Write(@homeDir@/Library/Messages/**)",
      "Edit(@homeDir@/Library/Messages/**)",
      "Read(@homeDir@/Library/Mail/**)",
      "Write(@homeDir@/Library/Mail/**)",
      "Edit(@homeDir@/Library/Mail/**)",
      "Read(@homeDir@/Library/Calendars/**)",
      "Write(@homeDir@/Library/Calendars/**)",
      "Edit(@homeDir@/Library/Calendars/**)",
      "Read(@homeDir@/Library/Application Support/AddressBook/**)",
      "Write(@homeDir@/Library/Application Support/AddressBook/**)",
      "Edit(@homeDir@/Library/Application Support/AddressBook/**)",
      "Read(@homeDir@/Library/Application Support/Bitwarden/**)",
      "Write(@homeDir@/Library/Application Support/Bitwarden/**)",
      "Edit(@homeDir@/Library/Application Support/Bitwarden/**)",
      "Read(@homeDir@/Library/Application Support/Signal/**)",
      "Write(@homeDir@/Library/Application Support/Signal/**)",
      "Edit(@homeDir@/Library/Application Support/Signal/**)",
      "Read(@homeDir@/Library/Application Support/Element/**)",
      "Write(@homeDir@/Library/Application Support/Element/**)",
      "Edit(@homeDir@/Library/Application Support/Element/**)",
      "Read(@homeDir@/Library/Application Support/Simplex/**)",
      "Write(@homeDir@/Library/Application Support/Simplex/**)",
      "Edit(@homeDir@/Library/Application Support/Simplex/**)",
      "Read(@homeDir@/Library/Application Support/Slack/**)",
      "Write(@homeDir@/Library/Application Support/Slack/**)",
      "Edit(@homeDir@/Library/Application Support/Slack/**)",
      "Read(@homeDir@/Library/Application Support/zoom.us/**)",
      "Write(@homeDir@/Library/Application Support/zoom.us/**)",
      "Edit(@homeDir@/Library/Application Support/zoom.us/**)",
      "Read(@homeDir@/Library/Application Support/discord/**)",
      "Write(@homeDir@/Library/Application Support/discord/**)",
      "Edit(@homeDir@/Library/Application Support/discord/**)",
      "Read(@homeDir@/Library/Application Support/obsidian/**)",
      "Write(@homeDir@/Library/Application Support/obsidian/**)",
      "Edit(@homeDir@/Library/Application Support/obsidian/**)",
      "Read(@homeDir@/Library/Application Support/BraveSoftware/**)",
      "Write(@homeDir@/Library/Application Support/BraveSoftware/**)",
      "Edit(@homeDir@/Library/Application Support/BraveSoftware/**)",
      "Read(@homeDir@/Library/Application Support/LibreWolf/**)",
      "Write(@homeDir@/Library/Application Support/LibreWolf/**)",
      "Edit(@homeDir@/Library/Application Support/LibreWolf/**)",
      "Read(@homeDir@/Library/Application Support/TorBrowser-Data/**)",
      "Write(@homeDir@/Library/Application Support/TorBrowser-Data/**)",
      "Edit(@homeDir@/Library/Application Support/TorBrowser-Data/**)",
      "Read(@homeDir@/Library/Application Support/Spotify/**)",
      "Write(@homeDir@/Library/Application Support/Spotify/**)",
      "Edit(@homeDir@/Library/Application Support/Spotify/**)",
      "Read(@homeDir@/Library/Application Support/Steam/**)",
      "Write(@homeDir@/Library/Application Support/Steam/**)",
      "Edit(@homeDir@/Library/Application Support/Steam/**)",
      "Read(@homeDir@/Library/Group Containers/*proton*/**)",
      "Write(@homeDir@/Library/Group Containers/*proton*/**)",
      "Edit(@homeDir@/Library/Group Containers/*proton*/**)",
      "Read(@homeDir@/Library/Group Containers/*WhatsApp*/**)",
      "Write(@homeDir@/Library/Group Containers/*WhatsApp*/**)",
      "Edit(@homeDir@/Library/Group Containers/*WhatsApp*/**)",
      "Read(@homeDir@/Library/Group Containers/group.com.apple.notes/**)",
      "Write(@homeDir@/Library/Group Containers/group.com.apple.notes/**)",
      "Edit(@homeDir@/Library/Group Containers/group.com.apple.notes/**)",
      "Read(@homeDir@/Library/Containers/com.apple.Notes/**)",
      "Write(@homeDir@/Library/Containers/com.apple.Notes/**)",
      "Edit(@homeDir@/Library/Containers/com.apple.Notes/**)",
      "Read(@homeDir@/.netrc)",
      "Write(@homeDir@/.netrc)",
      "Edit(@homeDir@/.netrc)",
      "Read(@homeDir@/.npmrc)",
      "Write(@homeDir@/.npmrc)",
      "Edit(@homeDir@/.npmrc)",
      "Read(@homeDir@/.pypirc)",
      "Write(@homeDir@/.pypirc)",
      "Edit(@homeDir@/.pypirc)",
      "Read(@homeDir@/.docker/config.json)",
      "Write(@homeDir@/.docker/config.json)",
      "Edit(@homeDir@/.docker/config.json)",
      "Read(@homeDir@/.zsh_history)",
      "Write(@homeDir@/.zsh_history)",
      "Edit(@homeDir@/.zsh_history)",
      "Read(@homeDir@/.bash_history)",
      "Write(@homeDir@/.bash_history)",
      "Edit(@homeDir@/.bash_history)",
      "Read(@homeDir@/.local/share/atuin/**)",
      "Write(@homeDir@/.local/share/atuin/**)",
      "Edit(@homeDir@/.local/share/atuin/**)",
      "Read(@homeDir@/.bash_sessions/**)",
      "Write(@homeDir@/.bash_sessions/**)",
      "Edit(@homeDir@/.bash_sessions/**)",
      "Read(/run/secrets/**)",
      "Write(/run/secrets/**)",
      "Edit(/run/secrets/**)",
      "mcp__git__git_add",
      "mcp__git__git_commit",
      "mcp__git__git_reset",
      "mcp__git__git_checkout"
    ]
  }
}
